<% content_for :title, @teacher_group_subject.subject.subjectName + " - " + @user.firstName + " " + @user.lastName %>
<script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
</script>
<div class="modal fade" id="addGrade" tabindex="-1" role="dialog" aria-labelledby="addGradeLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addGradeLabel">Dodaj ocenę</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Cofnij">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="gradeSelect">Wybierz ocenę</label>
          <select class="form-control" id="gradeSelect">
            <option>1</option>
            <option>1+</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
            <option>6</option>
          </select>
        </div>
        <div class="form-group">
          <label for="gradeSelect">Wybierz typ oceny</label>
          <select class="form-control" id="gradeTypeSelect">
            <option>Sprawdzian</option>
            <option>Kartkówka</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cofnij</button>
        <button type="button" class="btn btn-primary">Dodaj ocenę</button>
      </div>
    </div>
  </div>
</div>
<div class="container-fluid">
  <div class="container container-radius container-shadow container-padding-small bg-light">
    <h4 class="float-left font-weight-light">Lista ocen</h4>
    <ul class="container-header float-right">
      <li class="container-header"><h4 class="font-weight-light">Przedmiot:
        <kbd class="badge-dark"><%= @teacher_group_subject.subject.subjectName %></kbd></h4></li>
      <li class="container-header">
        <h4 class="font-weight-light">Klasa: <kbd class="badge-dark"><%= @teacher_group_subject.group.groupName %></kbd>
        </h4></li>
    </ul>
    <div class="table-responsive">
      <table class="table">
        <thead>
        <tr>
          <th scope="col">Numer</th>
          <th scope="col">Imię</th>
          <th scope="col">Nazwisko</th>
          <th scope="col" style="min-width: 200px">Oceny</th>
          <th scope="col">Średnia</th>
          <th scope="col">Akcje</th>
        </tr>
        </thead>
        <tbody>
        <% @teacher_group_subject.group.students.all.each do |student| %>
          <% avg = 0.0 %>
          <% i = 0 %>
          <tr>
            <td><kbd class="badge"><%= student.id %></kbd></td>
            <td scope="row"><%= student.user.firstName %></td>
            <td scope="row"><%= student.user.lastName %></td>
            <td>
              <ul class="grade-list">
                <% student.grades.where(subject: @teacher_group_subject.subject).all.each do |g| %>
                  <li class="grade-list"><span data-toggle="tooltip" data-placement="top" title=<%= g.info %>>
                  <%= label_tag 'grade', g.grade, :class => 'badge grade grade-' + g.grade[0] %></span>
                  </li>
                  <% avg += Grade.gradeValues(g.grade) %>
                  <% i += 1.0 %>
                <% end %>
              </ul>
            </td>
            <td><span class="badge badge-secondary"><%= (avg / i).round(2) %></span></td>
            <td>
              <ul class="grade-list">
                <li class="grade-list">
                  <kbd class="badge badge-dark"><a class="modal-action" data-toggle="modal" data-target="#addGrade" href="#">Dodaj
                    ocenę</a></kbd></li>
                <li class="grade-list">
                  <kbd class="badge badge-dark"><a class="modal-action" href="#">Edytuj oceny</a></kbd></li>
                <li class="grade-list">
                  <kbd class="badge badge-dark"><a class="modal-action" href="#">Zobacz ucznia</a></kbd></li>
              </ul>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>